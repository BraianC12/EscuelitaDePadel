{% extends "admin/base_admin.html" %}

{% block body %}
<h3 class="fw-bold mb-4">
    <i class="bi bi-cash"></i> Pagos recibidos
</h3>

<!--CARDS DE RESUMEN-->
<div class="row g-3 mb-4">

    <div class="col-12 col-md-6">
        <div class="card border-0 shadow-sm">
            <div class="card-body d-flex align-items-center gap-3">
                <div class="icon-box bg-success text-white">
                    <i class="bi bi-check-circle-fill fs-4"></i>
                </div>
                <div>    
                    <div class="text-muted small">Pago aprobados</div>
                    <div class="fs-4 fw-bold">{{ total_aprobados }}</div>
                </div>
            </div>
        </div>
    </div>

    <div class="col-12 col-md-6">
        <div class="card border-0 shadow-sm">
            <div class="card-body d-flex align-items-center gap-3">
                <div class="icon-box bg-warning text-dark">
                    <i class="bi bi-clock-fill fs-4"></i>
                </div>
                <div>    
                    <div class="text-muted small">Pago pendientes</div>
                    <div class="fs-4 fw-bold">{{ total_pendientes }}</div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="table-reponsive">
    <table class="table table-striped shadow-sm align-middle text-nowrap fade-slide">
    <thead>
        <tr>
            <th>Alumno</th>
            <th class="d-none d-md-table-cell">DNI</th>
            <th class="d-none d-md-table-cell">AÃ±o</th>
            <th>Mes</th>
            <th class="d-none d-md-table-cell">Monto</th>
            <th>Estado</th>
            <th>Comprobante</th>
            <th>AcciÃ³n</th>
        </tr>
    </thead>

    <tbody>
        {% for pago in pagos %}
        <tr>
            <td>{{ pago.alumno.apellido }} {{ pago.alumno.nombre }}</td>
            <td class="d-none d-md-table-cell">{{ pago.alumno.dni }}</td>
            <td class="d-none d-md-table-cell">{{ pago.anio }}</td>
            <td>{{ pago.mes_nombre }}</td>
            <td class="d-none d-md-table-cell">{{ pago.monto }}</td>
            <td>
                {% if pago.estado == "enviado" %}
                    ðŸŸ¡ En revisiÃ³n
                {% elif pago.estado == "aprobado" %}
                    ðŸŸ¢ Aprobado
                {% endif %}
            </td>

            <td>
                {% if pago.comprobante %}
                <a href="{{ url_for('static', filename='comprobantes/' + pago.comprobante) }}"
                   target="_blank"
                   class="btn btb-sm btn-success btn-action">
                    ðŸ“„ Ver
                </a>
                {% endif %}
            </td>

            <td>
                {% if pago.estado != "aprobado" %}
                <a href="{{ url_for('aprobar_pago', id=pago.id) }}"
                   class="btn btn-sm btn-success btn-action">
                     âœ” Aprobar
                </a>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
</div>


{% endblock %}